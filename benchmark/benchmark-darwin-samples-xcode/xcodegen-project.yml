# XCodeGen for the :benchmark:benchmark-darwin-samples module..

name: benchmark-darwin-sample-xcode
targets:

  testapp-ios:
    type: application
    platform: iOS
    info:
      path: Info.plist
    sources:
      - path: 'iosSources/main'
    scheme:
      testTargets:
        - testapp-ios-benchmarks
      gatherCoverageData: false
    settings:
      PRODUCT_NAME: testapp-ios

  testapp-ios-benchmarks:
    type: bundle.unit-test
    platform: iOS
    info:
      path: Info.plist
    sources:
      - path: 'iosAppUnitTests/main'
    scheme:
      preActions:
        - name: build AndroidXDarwinSampleBenchmarks.xcframework
          basedOnDependencyAnalysis: false
          settingsTarget: testapp-ios
          script: |
            cd ${PROJECT_DIR}/../..
            ./gradlew :benchmark:benchmark-darwin-samples:assembleAndroidXDarwinSampleBenchmarksDebugXCFramework \
                --no-configuration-cache                         \
                -Pandroidx.enabled.kmp.target.platforms="+MAC"
          outputFiles:
            - "${PROJECT_DIR}/../../../../out/androidx/benchmark/benchmark-darwin-samples/build/XCFrameworks/debug/AndroidXDarwinSampleBenchmarks.xcframework"
    dependencies:
      - framework: "${PROJECT_DIR}/../../../../out/androidx/benchmark/benchmark-darwin-samples/build/XCFrameworks/debug/AndroidXDarwinSampleBenchmarks.xcframework"
    settings:
      PRODUCT_NAME: testapp-ios-benchmarks

settings:
  PRODUCT_BUNDLE_IDENTIFIER: androidx.benchmark
  SWIFT_VERSION: 5
  CODE_SIGN_IDENTITY: ''
  CODE_SIGNING_REQUIRED: 'NO'
  CODE_SIGN_ENTITLEMENTS: ''
  CODE_SIGNING_ALLOWED: 'NO'
  IPHONEOS_DEPLOYMENT_TARGET: 15.2
